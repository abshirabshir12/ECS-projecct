{"ast":null,"code":"/** *******************************************************************************************************************\r\n  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\r\n\r\n  Licensed under the Apache License, Version 2.0 (the \"License\").\r\n  You may not use this file except in compliance with the License.\r\n  You may obtain a copy of the License at\r\n\r\n      http://www.apache.org/licenses/LICENSE-2.0\r\n\r\n  Unless required by applicable law or agreed to in writing, software\r\n  distributed under the License is distributed on an \"AS IS\" BASIS,\r\n  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n  See the License for the specific language governing permissions and\r\n  limitations under the License.\r\n ******************************************************************************************************************** */import{memo,useState,useEffect}from'react';import{useCollection}from'@cloudscape-design/collection-hooks';import{Box,Button,CollectionPreferences,Header,Pagination,Table,PropertyFilter}from'@cloudscape-design/components';import{columnDefinitions,getMatchesCountText,paginationLabels,collectionPreferencesProps,filteringConstants,filteringProperties}from'./table-config';import{useThreatsContext}from'../../../../contexts/ThreatsContext';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function EmptyState(_ref){let{title,subtitle,action}=_ref;return/*#__PURE__*/_jsxs(Box,{textAlign:\"center\",color:\"inherit\",children:[/*#__PURE__*/_jsx(Box,{variant:\"strong\",textAlign:\"center\",color:\"inherit\",children:title}),/*#__PURE__*/_jsx(Box,{variant:\"p\",padding:{bottom:'s'},color:\"inherit\",children:subtitle}),action]});}export default/*#__PURE__*/memo(_ref2=>{var _data$threats;let{threats,component,changeHandler}=_ref2;const[data,setData]=useState(component&&component.data||{});useEffect(()=>{setData(component&&component.data||{});},[component]);const updateData=(key,value,defaultValue)=>{if(component){setData({...data,[key]:value||defaultValue});changeHandler({[key]:value||defaultValue});}};const{onThreatListView}=useThreatsContext();const[preferences,setPreferences]=useState({pageSize:10,visibleContent:['statement','priority','stride'],wrapLines:true});const{items,actions,filteredItemsCount,collectionProps,paginationProps,propertyFilterProps}=useCollection(threats.map(item=>{var _item$metadata,_item$metadata$find,_item$metadata2,_item$metadata2$find;const output={};output.id=item.id;output.statement=item.statement;output.priority=(_item$metadata=item.metadata)===null||_item$metadata===void 0?void 0:(_item$metadata$find=_item$metadata.find(m=>m.key==='Priority'))===null||_item$metadata$find===void 0?void 0:_item$metadata$find.value;output.stride=(_item$metadata2=item.metadata)===null||_item$metadata2===void 0?void 0:(_item$metadata2$find=_item$metadata2.find(m=>m.key==='STRIDE'))===null||_item$metadata2$find===void 0?void 0:_item$metadata2$find.value.sort().join(',');return output;}),{propertyFiltering:{filteringProperties:filteringProperties,empty:/*#__PURE__*/_jsx(EmptyState,{title:\"No threats defined\",subtitle:\"\",action:/*#__PURE__*/_jsx(Button,{onClick:()=>onThreatListView===null||onThreatListView===void 0?void 0:onThreatListView(),children:\"Add threats\"})}),noMatch:/*#__PURE__*/_jsx(EmptyState,{title:\"No matches\",subtitle:\"\",action:/*#__PURE__*/_jsx(Button,{onClick:()=>actions.setFiltering(''),children:\"Clear filter\"})})},sorting:{},pagination:{pageSize:preferences.pageSize},selection:{defaultSelectedItems:component===null||component===void 0?void 0:component.data.threats,keepSelection:true,trackBy:'id'}});if(!component){return/*#__PURE__*/_jsx(EmptyState,{title:\"Select a component to view and assign threats\",subtitle:\"\",action:null});}return/*#__PURE__*/_jsx(Table,{...collectionProps,selectionType:\"multi\",header:/*#__PURE__*/_jsx(Header,{counter:(_data$threats=data.threats)!==null&&_data$threats!==void 0&&_data$threats.length?`(${data.threats.length}/${threats.length})`:`(${threats.length})`,children:\"Threats\"}),columnDefinitions:columnDefinitions,visibleColumns:preferences.visibleContent,items:items,trackBy:\"id\",selectedItems:data.threats,onSelectionChange:e=>updateData('threats',e.detail.selectedItems,[]),stickyHeader:true,resizableColumns:true,wrapLines:true,stripedRows:true,pagination:/*#__PURE__*/_jsx(Pagination,{...paginationProps,ariaLabels:paginationLabels}),preferences:/*#__PURE__*/_jsx(CollectionPreferences,{...collectionPreferencesProps,preferences:preferences,onConfirm:_ref3=>{let{detail}=_ref3;return setPreferences(detail);}}),filter:/*#__PURE__*/_jsx(PropertyFilter,{...propertyFilterProps,countText:getMatchesCountText(filteredItemsCount),expandToViewport:true,i18nStrings:filteringConstants})});});","map":{"version":3,"names":["memo","useState","useEffect","useCollection","Box","Button","CollectionPreferences","Header","Pagination","Table","PropertyFilter","columnDefinitions","getMatchesCountText","paginationLabels","collectionPreferencesProps","filteringConstants","filteringProperties","useThreatsContext","jsx","_jsx","jsxs","_jsxs","EmptyState","_ref","title","subtitle","action","textAlign","color","children","variant","padding","bottom","_ref2","_data$threats","threats","component","changeHandler","data","setData","updateData","key","value","defaultValue","onThreatListView","preferences","setPreferences","pageSize","visibleContent","wrapLines","items","actions","filteredItemsCount","collectionProps","paginationProps","propertyFilterProps","map","item","_item$metadata","_item$metadata$find","_item$metadata2","_item$metadata2$find","output","id","statement","priority","metadata","find","m","stride","sort","join","propertyFiltering","empty","onClick","noMatch","setFiltering","sorting","pagination","selection","defaultSelectedItems","keepSelection","trackBy","selectionType","header","counter","length","visibleColumns","selectedItems","onSelectionChange","e","detail","stickyHeader","resizableColumns","stripedRows","ariaLabels","onConfirm","_ref3","filter","countText","expandToViewport","i18nStrings"],"sources":["C:/Users/abshi/OneDrive/Documents/yyyy/ECS-projecct/app/src/components/generic/Flow/Threats/ThreatList.tsx"],"sourcesContent":["/** *******************************************************************************************************************\r\n  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\r\n\r\n  Licensed under the Apache License, Version 2.0 (the \"License\").\r\n  You may not use this file except in compliance with the License.\r\n  You may obtain a copy of the License at\r\n\r\n      http://www.apache.org/licenses/LICENSE-2.0\r\n\r\n  Unless required by applicable law or agreed to in writing, software\r\n  distributed under the License is distributed on an \"AS IS\" BASIS,\r\n  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n  See the License for the specific language governing permissions and\r\n  limitations under the License.\r\n ******************************************************************************************************************** */\r\nimport { memo, useState, useEffect } from 'react';\r\nimport { useCollection } from '@cloudscape-design/collection-hooks';\r\nimport {\r\n  Box,\r\n  Button,\r\n  CollectionPreferences,\r\n  CollectionPreferencesProps,\r\n  Header,\r\n  Pagination,\r\n  Table,\r\n  PropertyFilter,\r\n} from '@cloudscape-design/components';\r\nimport { columnDefinitions, getMatchesCountText, paginationLabels, collectionPreferencesProps, filteringConstants, filteringProperties } from './table-config';\r\nimport { useThreatsContext } from '../../../../contexts/ThreatsContext';\r\n\r\nfunction EmptyState({ title, subtitle, action }) {\r\n  return (\r\n    <Box textAlign=\"center\" color=\"inherit\">\r\n      <Box variant=\"strong\" textAlign=\"center\" color=\"inherit\">\r\n        {title}\r\n      </Box>\r\n      <Box variant=\"p\" padding={{ bottom: 's' }} color=\"inherit\">\r\n        {subtitle}\r\n      </Box>\r\n      {action}\r\n    </Box>\r\n  );\r\n}\r\n\r\nexport default memo(({ threats, component, changeHandler }: { threats: any; component: any; changeHandler: any } ) => {\r\n\r\n  const [data, setData] = useState((component && component.data) || {});\r\n\r\n  useEffect(() => {\r\n    setData((component && component.data) || {});\r\n  }, [component]);\r\n\r\n  const updateData = (key, value, defaultValue) => {\r\n    if (component) {\r\n      setData({ ...data, [key]: value || defaultValue });\r\n      changeHandler({ [key]: value || defaultValue });\r\n    }\r\n  };\r\n\r\n  const { onThreatListView } = useThreatsContext();\r\n\r\n  const [preferences, setPreferences] = useState<CollectionPreferencesProps.Preferences>({\r\n    pageSize: 10,\r\n    visibleContent: ['statement', 'priority', 'stride'],\r\n    wrapLines: true,\r\n  });\r\n\r\n  const {\r\n    items,\r\n    actions,\r\n    filteredItemsCount,\r\n    collectionProps,\r\n    paginationProps,\r\n    propertyFilterProps,\r\n  } = useCollection(\r\n    threats.map((item) => {\r\n      const output: any = {};\r\n      output.id = item.id;\r\n      output.statement = item.statement;\r\n      output.priority = item.metadata?.find(m => m.key === 'Priority')?.value;\r\n      output.stride = item.metadata?.find(m => m.key === 'STRIDE')?.value.sort().join(',');\r\n      return output;\r\n    }),\r\n    {\r\n      propertyFiltering: {\r\n        filteringProperties: filteringProperties,\r\n        empty: (\r\n          <EmptyState\r\n            title=\"No threats defined\"\r\n            subtitle=\"\"\r\n            action={<Button onClick={() => onThreatListView?.()}>Add threats</Button>}\r\n          />\r\n        ),\r\n        noMatch: (\r\n          <EmptyState\r\n            title=\"No matches\"\r\n            subtitle=\"\"\r\n            action={\r\n              <Button onClick={() => actions.setFiltering('')}>\r\n              Clear filter\r\n              </Button>\r\n            }\r\n          />\r\n        ),\r\n      },\r\n      sorting: {},\r\n      pagination: { pageSize: preferences.pageSize },\r\n      selection: {\r\n        defaultSelectedItems: component?.data.threats,\r\n        keepSelection: true,\r\n        trackBy: 'id',\r\n      },\r\n    });\r\n\r\n  if (!component) {\r\n    return <EmptyState title=\"Select a component to view and assign threats\" subtitle=\"\" action={null} />;\r\n  }\r\n\r\n  return (\r\n    <Table\r\n      {...collectionProps}\r\n      selectionType=\"multi\"\r\n      header={\r\n        <Header\r\n          counter={\r\n            data.threats?.length\r\n              ? `(${data.threats.length}/${threats.length})`\r\n              : `(${threats.length})`\r\n          }\r\n        >\r\n          Threats\r\n        </Header>\r\n      }\r\n      columnDefinitions={columnDefinitions}\r\n      visibleColumns={preferences.visibleContent}\r\n      items={items}\r\n      trackBy=\"id\"\r\n      selectedItems={data.threats}\r\n      onSelectionChange={(e) => updateData('threats', e.detail.selectedItems, [])}\r\n      stickyHeader\r\n      resizableColumns\r\n      wrapLines\r\n      stripedRows\r\n      pagination={\r\n        <Pagination {...paginationProps} ariaLabels={paginationLabels} />\r\n      }\r\n      preferences={\r\n        <CollectionPreferences\r\n          {...collectionPreferencesProps}\r\n          preferences={preferences}\r\n          onConfirm={({ detail }) => setPreferences(detail)}\r\n        />\r\n      }\r\n      filter={\r\n        <PropertyFilter\r\n          {...propertyFilterProps}\r\n          countText={getMatchesCountText(filteredItemsCount)}\r\n          expandToViewport={true}\r\n          i18nStrings={filteringConstants}\r\n        />\r\n      }\r\n    />\r\n  );\r\n});"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}