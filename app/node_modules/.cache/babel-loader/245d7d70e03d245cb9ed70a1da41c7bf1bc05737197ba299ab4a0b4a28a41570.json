{"ast":null,"code":"import{useCallback,useEffect,useState}from'react';import ReactFlow,{Controls,Background,addEdge,useEdgesState,useNodesState,ConnectionMode,Panel,useReactFlow,applyEdgeChanges,applyNodeChanges,MarkerType}from'reactflow';import styled from'@emotion/styled';import Container from'@cloudscape-design/components/container';import Header from'@cloudscape-design/components/header';import SpaceBetween from'@cloudscape-design/components/space-between';import{v4}from'uuid';import'reactflow/dist/style.css';import ActorNode from'./Nodes/ActorNode';import DatastoreNode from'./Nodes/DatastoreNode';import ProcessNode from'./Nodes/ProcessNode';import TrustBoundaryNode from'./Nodes/TrustBoundaryNode';import NodeSelector from'./Nodes/NodeSelector';import BiDirectionalEdge from'./Edges/BiDirectionalEdge';import PropertiesPanel from'./Properties/PropertiesPanel';import SaveButton from'./SaveButton/SaveButton';import ZIndexChanger from'./Nodes/ZIndexChanger';import ThreatList from'./Threats/ThreatList';import{useFlowContext,useThreatsContext}from'../../../contexts';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const edgeTypes={biDirectional:BiDirectionalEdge};const nodeTypes={actor:ActorNode,datastore:DatastoreNode,process:ProcessNode,trustBoundary:TrustBoundaryNode};let s;(function(_s){const OuterContainer=_s.OuterContainer=styled.div`\n    height: 450px;\n    display: flex;\n    border: 1px solid #000;\n\n     svg.react-flow__edges {\n      z-index: 1 !important;\n     }\n  `;})(s||(s={}));function Flow(){const{zoomTo,getZoom,setViewport}=useReactFlow();// Save and restore state\nconst[rfInstance,setRfInstance]=useState(null);const[saveState,setSaveState]=useState(true);const[nodes,setNodes]=useNodesState([]);const[edges,setEdges]=useEdgesState([]);const{flow,setFlow}=useFlowContext();const onSave=useCallback(()=>{if(rfInstance){setFlow({content:JSON.stringify(rfInstance.toObject())});setSaveState(true);}},[rfInstance,setFlow]);const restoreFlow=useCallback(async()=>{if(flow.content){const diagram=JSON.parse(flow.content||'{}');const{x=0,y=0,zoom=1}=diagram.viewport;setNodes(diagram.nodes||[]);setEdges(diagram.edges||[]);setViewport({x,y,zoom});}},[flow.content,setNodes,setEdges,setViewport]);useEffect(()=>{restoreFlow().catch(console.error);},[flow.content,restoreFlow]);const onInit=async instance=>{setRfInstance(instance);await restoreFlow();};// Nodes and edges state\nconst[nodeDataValue,setNodeDataValue]=useState({});const[selectedComponent,setSelectedComponent]=useState(null);useEffect(()=>{if(!selectedComponent){// If this is the first node added to the flow, zoom out to prevent an implicit max zoom (of 4)\n// this is probably another bug in react-flow that needs to be investigated and reported\nif(nodes.length===1&&getZoom()===4){zoomTo(1);}return;}setEdges(eds=>eds.map(edge=>{if(edge.id===(selectedComponent===null||selectedComponent===void 0?void 0:selectedComponent.id)){edge.data={...edge.data,...nodeDataValue};}return edge;}));setNodes(nds=>nds.map(node=>{if(node.id===(selectedComponent===null||selectedComponent===void 0?void 0:selectedComponent.id)){node.data={...node.data,...nodeDataValue};}return node;}));setSaveState(false);},[selectedComponent,nodeDataValue,setNodes,setEdges,getZoom,zoomTo,nodes.length]);const onNodesChange=useCallback(changes=>{setNodeDataValue({});setNodes(oldNodes=>applyNodeChanges(changes,oldNodes));for(let selection of changes.filter(c=>c.type==='select'||c.type==='position'&&c.dragging===false||c.type==='remove')){if(selection.selected||selection.dragging===false){setSelectedComponent(nodes.find(node=>node.id===selection.id));}else{setSelectedComponent(null);}};},[nodes,setNodes]);const onEdgesChange=useCallback(changes=>{setNodeDataValue({});setEdges(oldEdges=>applyEdgeChanges(changes,oldEdges));setSelectedComponent(null);for(let selection of changes.filter(c=>c.type==='select')){if(selection.selected){setSelectedComponent(edges.find(edge=>edge.id===selection.id));}else{setSelectedComponent(null);}}},[edges,setEdges]);const onConnect=useCallback(params=>{const newEdge={...params,id:v4(),type:'biDirectional',data:{name:'Data',description:'',outOfScope:false,scopeReason:'',dataTags:[],techTags:[],securityTags:[],tags:[],selectedThreats:[]}};setEdges(eds=>addEdge(addEndMarker(newEdge),eds));setNodeDataValue({});},[setEdges]);const onAdd=useCallback(type=>{setNodes(nds=>{// Randomize position for new nodes using a position from -100 to 100\nlet x=Math.floor(Math.random()*200)-100;let y=Math.floor(Math.random()*200)-100;const newNode={id:v4(),data:{name:type,description:'',outOfScope:false,scopeReason:'',dataTags:[],techTags:[],securityTags:[],tags:[],selectedThreats:[]},type,position:{x,y}};setSaveState(false);return[...nds,newNode];});},[setNodes]);const onZIndexChange=useCallback(direction=>{setNodes(nds=>{const selectedNode=nds.find(node=>node.id===(selectedComponent===null||selectedComponent===void 0?void 0:selectedComponent.id));if(!selectedNode){return nds;}const index=nds.indexOf(selectedNode);const newIndex=direction==='last'?0:direction==='down'?index-1:direction==='up'?index+1:nds.length-1;const node=nds.splice(index,1)[0];nds.splice(newIndex,0,node);setSaveState(false);return[...nds];});},[setNodes,selectedComponent]);// Threats state\nconst{statementList}=useThreatsContext();const[threatList,setThreatList]=useState(statementList);useEffect(()=>{// update list of threats panel\nsetThreatList(statementList);},[setThreatList,statementList]);const addEndMarker=edge=>({...edge,markerEnd:{type:MarkerType.ArrowClosed,width:20,height:20,color:'#b1b1b7'}});return/*#__PURE__*/_jsxs(SpaceBetween,{direction:\"vertical\",size:\"s\",children:[/*#__PURE__*/_jsx(Container,{header:/*#__PURE__*/_jsx(Header,{actions:/*#__PURE__*/_jsx(SaveButton,{saveHandler:onSave,saveState:saveState}),children:\"Data flow diagram\"}),children:/*#__PURE__*/_jsx(s.OuterContainer,{children:/*#__PURE__*/_jsxs(ReactFlow,{nodes:nodes,onNodesChange:onNodesChange,edges:edges,onEdgesChange:onEdgesChange,onConnect:onConnect,edgeTypes:edgeTypes,nodeTypes:nodeTypes,minZoom:0.2,maxZoom:4,fitView:true,connectionMode:ConnectionMode.Loose,onInit:onInit,children:[/*#__PURE__*/_jsx(Background,{}),/*#__PURE__*/_jsx(Controls,{}),/*#__PURE__*/_jsx(Panel,{position:\"top-left\",children:/*#__PURE__*/_jsx(NodeSelector,{addCallback:onAdd})}),/*#__PURE__*/_jsx(Panel,{position:\"top-right\",children:/*#__PURE__*/_jsx(ZIndexChanger,{addCallback:onZIndexChange})})]})})}),/*#__PURE__*/_jsx(Container,{header:/*#__PURE__*/_jsx(Header,{children:\"Properties\"}),children:/*#__PURE__*/_jsx(PropertiesPanel,{component:selectedComponent,changeHandler:setNodeDataValue})}),/*#__PURE__*/_jsx(ThreatList,{threats:threatList,component:selectedComponent,changeHandler:setNodeDataValue})]});}export default Flow;","map":{"version":3,"names":["useCallback","useEffect","useState","ReactFlow","Controls","Background","addEdge","useEdgesState","useNodesState","ConnectionMode","Panel","useReactFlow","applyEdgeChanges","applyNodeChanges","MarkerType","styled","Container","Header","SpaceBetween","v4","ActorNode","DatastoreNode","ProcessNode","TrustBoundaryNode","NodeSelector","BiDirectionalEdge","PropertiesPanel","SaveButton","ZIndexChanger","ThreatList","useFlowContext","useThreatsContext","jsx","_jsx","jsxs","_jsxs","edgeTypes","biDirectional","nodeTypes","actor","datastore","process","trustBoundary","s","_s","OuterContainer","div","Flow","zoomTo","getZoom","setViewport","rfInstance","setRfInstance","saveState","setSaveState","nodes","setNodes","edges","setEdges","flow","setFlow","onSave","content","JSON","stringify","toObject","restoreFlow","diagram","parse","x","y","zoom","viewport","catch","console","error","onInit","instance","nodeDataValue","setNodeDataValue","selectedComponent","setSelectedComponent","length","eds","map","edge","id","data","nds","node","onNodesChange","changes","oldNodes","selection","filter","c","type","dragging","selected","find","onEdgesChange","oldEdges","onConnect","params","newEdge","name","description","outOfScope","scopeReason","dataTags","techTags","securityTags","tags","selectedThreats","addEndMarker","onAdd","Math","floor","random","newNode","position","onZIndexChange","direction","selectedNode","index","indexOf","newIndex","splice","statementList","threatList","setThreatList","markerEnd","ArrowClosed","width","height","color","size","children","header","actions","saveHandler","minZoom","maxZoom","fitView","connectionMode","Loose","addCallback","component","changeHandler","threats"],"sources":["C:/Users/abshi/OneDrive/Documents/yyyy/ECS-projecct/app/src/components/generic/Flow/index.tsx"],"sourcesContent":["import { useCallback, useEffect, useState } from 'react';\r\nimport ReactFlow, {\r\n  Controls,\r\n  Background,\r\n  addEdge,\r\n  useEdgesState,\r\n  useNodesState,\r\n  ConnectionMode,\r\n  Panel,\r\n  Node,\r\n  Edge,\r\n  ReactFlowInstance,\r\n  useReactFlow,\r\n  applyEdgeChanges,\r\n  applyNodeChanges,\r\n  MarkerType,\r\n} from 'reactflow';\r\nimport styled from '@emotion/styled';\r\nimport Container from '@cloudscape-design/components/container';\r\nimport Header from '@cloudscape-design/components/header';\r\nimport SpaceBetween from '@cloudscape-design/components/space-between';\r\nimport { v4 } from 'uuid';\r\nimport 'reactflow/dist/style.css';\r\n\r\nimport ActorNode from './Nodes/ActorNode';\r\nimport DatastoreNode from './Nodes/DatastoreNode';\r\nimport ProcessNode from './Nodes/ProcessNode';\r\nimport TrustBoundaryNode from './Nodes/TrustBoundaryNode';\r\nimport NodeSelector from './Nodes/NodeSelector';\r\n\r\nimport BiDirectionalEdge from './Edges/BiDirectionalEdge';\r\n\r\nimport PropertiesPanel from './Properties/PropertiesPanel';\r\nimport SaveButton from './SaveButton/SaveButton';\r\nimport ZIndexChanger from './Nodes/ZIndexChanger';\r\n\r\nimport ThreatList from './Threats/ThreatList';\r\n\r\nimport { useFlowContext, useThreatsContext } from '../../../contexts';\r\n\r\nconst edgeTypes = {\r\n  biDirectional: BiDirectionalEdge,\r\n};\r\n\r\nconst nodeTypes = {\r\n  actor: ActorNode,\r\n  datastore: DatastoreNode,\r\n  process: ProcessNode,\r\n  trustBoundary: TrustBoundaryNode,\r\n};\r\n\r\nnamespace s {\r\n  export const OuterContainer = styled.div`\r\n    height: 450px;\r\n    display: flex;\r\n    border: 1px solid #000;\r\n\r\n     svg.react-flow__edges {\r\n      z-index: 1 !important;\r\n     }\r\n  `;\r\n}\r\n\r\nfunction Flow() {\r\n  const { zoomTo, getZoom, setViewport } = useReactFlow();\r\n\r\n  // Save and restore state\r\n  const [rfInstance, setRfInstance] = useState<ReactFlowInstance<any, any> | null>(null);\r\n  const [saveState, setSaveState] = useState(true);\r\n  const [nodes, setNodes] = useNodesState([]);\r\n  const [edges, setEdges] = useEdgesState([]);\r\n\r\n  const { flow, setFlow } = useFlowContext();\r\n\r\n  const onSave = useCallback(() => {\r\n    if (rfInstance) {\r\n      setFlow({ content: JSON.stringify(rfInstance.toObject()) });\r\n      setSaveState(true);\r\n    }\r\n  }, [rfInstance, setFlow]);\r\n\r\n  const restoreFlow = useCallback(async () => {\r\n    if (flow.content) {\r\n      const diagram = JSON.parse(flow.content || '{}');\r\n      const { x = 0, y = 0, zoom = 1 } = diagram.viewport;\r\n      setNodes(diagram.nodes || []);\r\n      setEdges(diagram.edges || []);\r\n      setViewport({ x, y, zoom });\r\n    }\r\n  }, [flow.content, setNodes, setEdges, setViewport]);\r\n\r\n  useEffect(() => {\r\n    restoreFlow().catch(console.error);\r\n  }, [flow.content, restoreFlow]);\r\n\r\n  const onInit = async (instance) => {\r\n    setRfInstance(instance);\r\n    await restoreFlow();\r\n  };\r\n\r\n  // Nodes and edges state\r\n  const [nodeDataValue, setNodeDataValue] = useState({});\r\n  const [selectedComponent, setSelectedComponent] = useState<Node | Edge | null>(null);\r\n\r\n  useEffect(() => {\r\n    if (!selectedComponent) {\r\n      // If this is the first node added to the flow, zoom out to prevent an implicit max zoom (of 4)\r\n      // this is probably another bug in react-flow that needs to be investigated and reported\r\n      if (nodes.length === 1 && getZoom() === 4) {\r\n        zoomTo(1);\r\n      }\r\n      return;\r\n    }\r\n\r\n    setEdges((eds) =>\r\n      eds.map((edge) => {\r\n        if (edge.id === selectedComponent?.id) {\r\n          edge.data = { ...edge.data, ...nodeDataValue };\r\n        }\r\n        return edge;\r\n      }));\r\n    setNodes((nds) =>\r\n      nds.map((node) => {\r\n        if (node.id === selectedComponent?.id) {\r\n          node.data = { ...node.data, ...nodeDataValue };\r\n        }\r\n        return node;\r\n      }));\r\n    setSaveState(false);\r\n  }, [selectedComponent, nodeDataValue, setNodes, setEdges, getZoom, zoomTo, nodes.length]);\r\n\r\n  const onNodesChange = useCallback(\r\n    (changes) => {\r\n      setNodeDataValue({});\r\n      setNodes((oldNodes) => applyNodeChanges(changes, oldNodes));\r\n      for (let selection of changes.filter(c => c.type === 'select' || (c.type === 'position' && c.dragging === false) || c.type ==='remove')) {\r\n        if (selection.selected || selection.dragging === false) {\r\n          setSelectedComponent(nodes.find((node) => node.id === selection.id) as Node | null);\r\n        } else {\r\n          setSelectedComponent(null);\r\n        }\r\n      };\r\n    },\r\n    [nodes, setNodes],\r\n  );\r\n\r\n  const onEdgesChange = useCallback(\r\n    (changes) => {\r\n      setNodeDataValue({});\r\n      setEdges((oldEdges) => applyEdgeChanges(changes, oldEdges));\r\n      setSelectedComponent(null);\r\n      for (let selection of changes.filter(c => c.type === 'select')) {\r\n        if (selection.selected) {\r\n          setSelectedComponent(edges.find((edge) => edge.id === selection.id) as Edge | null);\r\n        } else {\r\n          setSelectedComponent(null);\r\n        }\r\n      }\r\n    },\r\n    [edges, setEdges],\r\n  );\r\n\r\n  const onConnect = useCallback(\r\n    (params) => {\r\n      const newEdge =\r\n      {\r\n        ...params,\r\n        id: v4(),\r\n        type: 'biDirectional',\r\n        data: {\r\n          name: 'Data',\r\n          description: '',\r\n          outOfScope: false,\r\n          scopeReason: '',\r\n          dataTags: [],\r\n          techTags: [],\r\n          securityTags: [],\r\n          tags: [],\r\n          selectedThreats: [],\r\n        },\r\n      };\r\n      setEdges((eds) => addEdge(addEndMarker(newEdge), eds));\r\n      setNodeDataValue({});\r\n    }, [setEdges],\r\n  );\r\n\r\n  const onAdd = useCallback((type: string) => {\r\n    setNodes((nds) => {\r\n      // Randomize position for new nodes using a position from -100 to 100\r\n      let x = Math.floor(Math.random() * 200) - 100;\r\n      let y = Math.floor(Math.random() * 200) - 100;\r\n\r\n      const newNode = {\r\n        id: v4(),\r\n        data: {\r\n          name: type,\r\n          description: '',\r\n          outOfScope: false,\r\n          scopeReason: '',\r\n          dataTags: [],\r\n          techTags: [],\r\n          securityTags: [],\r\n          tags: [],\r\n          selectedThreats: [],\r\n        },\r\n        type,\r\n        position: { x, y },\r\n      };\r\n      setSaveState(false);\r\n      return [...nds, newNode];\r\n    });\r\n  }, [setNodes]);\r\n\r\n  const onZIndexChange = useCallback((direction: string) => {\r\n    setNodes((nds) => {\r\n      const selectedNode = nds.find((node) => node.id === selectedComponent?.id);\r\n      if (!selectedNode) {\r\n        return nds;\r\n      }\r\n      const index = nds.indexOf(selectedNode);\r\n      const newIndex = direction === 'last' ? 0 : direction === 'down' ? index - 1 : direction === 'up' ? index + 1 : nds.length - 1;\r\n      const node = nds.splice(index, 1)[0];\r\n      nds.splice(newIndex, 0, node);\r\n      setSaveState(false);\r\n      return [...nds];\r\n    });\r\n  }, [setNodes, selectedComponent]);\r\n\r\n  // Threats state\r\n  const { statementList } = useThreatsContext();\r\n  const [threatList, setThreatList] = useState(statementList);\r\n\r\n  useEffect(() => { // update list of threats panel\r\n    setThreatList(statementList);\r\n  }, [setThreatList, statementList]);\r\n\r\n  const addEndMarker = (edge) => ({\r\n    ...edge,\r\n    markerEnd: {\r\n      type: MarkerType.ArrowClosed,\r\n      width: 20,\r\n      height: 20,\r\n      color: '#b1b1b7',\r\n    },\r\n  });\r\n\r\n  return (\r\n    <SpaceBetween direction=\"vertical\" size=\"s\">\r\n      <Container header={<Header actions={<SaveButton saveHandler={onSave} saveState={saveState} />}>Data flow diagram</Header>}>\r\n        <s.OuterContainer>\r\n          <ReactFlow\r\n            nodes={nodes}\r\n            onNodesChange={onNodesChange}\r\n            edges={edges}\r\n            onEdgesChange={onEdgesChange}\r\n            onConnect={onConnect}\r\n            edgeTypes={edgeTypes}\r\n            nodeTypes={nodeTypes}\r\n            minZoom={0.2}\r\n            maxZoom={4}\r\n            fitView\r\n            connectionMode={ConnectionMode.Loose}\r\n            onInit={onInit}\r\n          >\r\n            <Background />\r\n            <Controls />\r\n            <Panel position=\"top-left\"><NodeSelector addCallback={onAdd} /></Panel>\r\n            <Panel position=\"top-right\"><ZIndexChanger addCallback={onZIndexChange} /></Panel>\r\n          </ReactFlow>\r\n        </s.OuterContainer>\r\n      </Container>\r\n      <Container header={<Header>Properties</Header>}>\r\n        <PropertiesPanel component={selectedComponent} changeHandler={setNodeDataValue} />\r\n      </Container>\r\n      <ThreatList\r\n        threats={threatList}\r\n        component={selectedComponent}\r\n        changeHandler={setNodeDataValue} />\r\n    </SpaceBetween>\r\n  );\r\n}\r\n\r\nexport default Flow;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}